## 第 21 章 Makefile 基础


### 21.1 基本规则

* Makefile 和源代码放在同一目录下
* make 程序会自动读取当前目录下的 Makefile

```c
target ... : prerequisites ...
	command 1
	command 2
	...
```

* 欲更新目标，必须先更新它的所有条件；所有条件中只要有一个条件被更新了，目标也必须随之被更新.
* 每条命令必须以一个 Tab 开头
* 第一条规则的目标称为缺省目标，只要缺省目标更新了就算完成任务了
* 通常 Makefile 都会有一个 clean 规则，用于清除编译过程中产生的二进制文件
* 
* `@` 不显示命令本身而至显示它的输出结果
* `-` 出错后继续执行
* `.PHONY: clean` 伪目标

**约定俗称目标名字**

* `all`, 执行主要的编译工作，通常用作缺省目标
* `install`, 执行编译后的安装
* `clean`, 删除编译生成的二进制文件
* `distclean`, 不仅删除编译生成的二进制文件，也删除其他生成的文件

### 21.2 隐含规则和模式规则

* 一个目标依赖的所有条件不一定非得写在一条规则中，也可以拆开写
* 如果一个目标拆开写多条规则，其中只有一条规则允许有命令列表

**隐含规则**

> 没有命令列表： `make -p`

**模式规则**

* `$@` 当前规则目标
* `$<` 当前规则中的第一个条件